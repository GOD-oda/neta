<!DOCTYPE html>
<html lang="ja" prefix="og: http://ogp.me/ns#">
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1.0, user-scalable=no" />
  <meta name="description" content="前提 Laravelの初期化が終わっている versionは9.19 Lighthouseを使う versionは5.64 コードはこちらにまとめてあ" />
  <meta property="og:title" content="LaravelでGraphQLを使う" />
  <meta property="og:type" content="article" />
  <meta property="og:image" content="https://oda.world/images/ogImage/129.png" />
  <meta property="og:site_name" content="ODA WORLD" />
  <meta property="og:description" content="前提 Laravelの初期化が終わっている versionは9.19 Lighthouseを使う versionは5.64 コードはこちらにまとめてあ" />
  <meta name="twitter:card" content="summary_large_image" />
  <meta name="twitter:site" content="@oskfjzp" />
  <meta name="twitter:player" content="@oskfjzp" />
  <title>LaravelでGraphQLを使う</title>

  
  <link rel="apple-touch-icon" sizes="57x57" href="https://oda.world/apple-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="https://oda.world/apple-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="https://oda.world/apple-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="https://oda.world/apple-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="https://oda.world/apple-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="https://oda.world/apple-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="https://oda.world/apple-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="https://oda.world/apple-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="https://oda.world/apple-icon-180x180.png">
  <link rel="icon" type="image/png" sizes="192x192"  href="https://oda.world/android-icon-192x192.png">
  <link rel="icon" type="image/png" sizes="32x32" href="https://oda.world/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="96x96" href="https://oda.world/favicon-96x96.png">
  <link rel="icon" type="image/png" sizes="16x16" href="https://oda.world/favicon-16x16.png">
  <link rel="manifest" href="https://oda.world/manifest.json">
  <meta name="msapplication-TileColor" content="#ffffff">
  <meta name="msapplication-TileImage" content="/ms-icon-144x144.png">
  <meta name="theme-color" content="#ffffff">

  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.6.0/styles/tomorrow-night-bright.min.css">

  
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">
  
  <link rel="stylesheet" href="https://oda.world/sass/main.min.18dabd5b90f48e6861583fa08160bf89651247df35f6ec24c572f54f8203485d.css">

  
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-M5XP83QSK8"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'G-M5XP83QSK8');
  </script>

  <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-6572411330656614"
          crossorigin="anonymous"></script>
</head>
<body>
  <header>
    <div class="container">
      <h1 class="text-center">LaravelでGraphQLを使う</h1>
      <div class="icon-content d-flex justify-content-evenly">
        
        
        <a href="https://github.com/GOD-oda"><img src="https://oda.world/images/github.png"></a>
        
        
        <a href="https://www.facebook.com/last.pass.oda"><img src="https://oda.world/images/facebook.png"></a>
        
        
        <a href="https://twitter.com/@oskfjzp"><img src="https://oda.world/images/twitter.png"></a>
        
        
        
        <a href="https://oda.world/index.xml"><img src="https://oda.world/images/feed.png"></a>
      </div>
    </div>
  </header>



<article>
  <div class="container">
    <aside class="mb-1 text-end">
      <div class="publish-date">
        公開日: <time datetime="2022-11-13 18:06:03 &#43;0900 JST">2022/11/13 18:06:03</time>
      </div>
      <div class="updated-date">
        更新日: <time datetime="2022-11-24 14:39:05 &#43;0900 JST">2022/11/24 14:39:05</time>
      </div>
    </aside>

    <div class="section row">
      <div class="col-md-9">
        <div class="content">
          <h2 id="前提">前提</h1>
<ul>
<li>Laravelの初期化が終わっている
<ul>
<li>versionは<code>9.19</code></li>
</ul>
</li>
<li><a href="https://lighthouse-php.com/">Lighthouse</a>を使う
<ul>
<li>versionは<code>5.64</code></li>
</ul>
</li>
</ul>
<p>コードは<a href="https://github.com/GOD-oda/neta/tree/master/issues/129">こちら</a>にまとめてある</p>
<h2 id="sqlite準備">sqlite準備</h1>
<ul>
<li><code>DB_CONNECTION</code>を<code>sqlite</code>にする</li>
<li><code>DB_DATABASE</code>をコメントアウトする</li>
<li>空の<code>database/database.sqlite</code>を作成する</li>
</ul>
<div class="highlight" fn="src/.env"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-env" data-lang="env">.
.
.
DB_CONNECTION<span style="color:#f92672">=</span>sqlite
DB_HOST<span style="color:#f92672">=</span>127.0.0.1
DB_PORT<span style="color:#f92672">=</span><span style="color:#ae81ff">3306</span>
<span style="color:#75715e">#DB_DATABASE=laravel</span>
DB_USERNAME<span style="color:#f92672">=</span>root
DB_PASSWORD<span style="color:#f92672">=</span>
.
.
.
</code></pre></div><p>マイグレーションと初期データを入れる（<code>database/seeders/DatabaseSeeder.php</code>のコメントアウトを外しておく）</p>
<div class="highlight" fn="database/seeders/DatabaseSeeder.php"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-diff" data-lang="diff">public function run()
{
<span style="color:#f92672">-   // \App\Models\User::factory(10)-&gt;create();
</span><span style="color:#f92672"></span><span style="color:#a6e22e">+   \App\Models\User::factory(10)-&gt;create();
</span><span style="color:#a6e22e"></span>
    // \App\Models\User::factory()-&gt;create([
    //     &#39;name&#39; =&gt; &#39;Test User&#39;,
    //     &#39;email&#39; =&gt; &#39;test@example.com&#39;,
    // ]);
}
</code></pre></div><div class="highlight" fn="shell"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">% docker compose exec app php artisan migrate:migrate --seed
</code></pre></div><h2 id="lighthouseをインストールする">Lighthouseをインストールする</h1>
<p>コンテナにてコマンドを実行する</p>
<div class="highlight" fn="shell"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">% composer require nuwave/lighthouse
</code></pre></div><p>インストールが完了した時点で<code>graphql</code>というエンドポイントが増えていることが確認できる</p>
<div class="highlight" fn="shell"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">% php artisan route:list

  GET|HEAD   / ...................................................................................................................... 
  POST       _ignition/execute-solution ............... ignition.executeSolution › Spatie<span style="color:#ae81ff">\L</span>aravelIgnition › ExecuteSolutionController
  GET|HEAD   _ignition/health-check ........................... ignition.healthCheck › Spatie<span style="color:#ae81ff">\L</span>aravelIgnition › HealthCheckController
  POST       _ignition/update-config ........................ ignition.updateConfig › Spatie<span style="color:#ae81ff">\L</span>aravelIgnition › UpdateConfigController
  GET|HEAD   api/user ............................................................................................................... 
  GET|HEAD   api/users .............................................................................................................. 
  GET|POST|HEAD graphql ............................................................. graphql › Nuwave<span style="color:#ae81ff">\L</span>ighthouse › GraphQLController
  GET|HEAD   sanctum/csrf-cookie .................................. sanctum.csrf-cookie › Laravel<span style="color:#ae81ff">\S</span>anctum › CsrfCookieController@show
</code></pre></div><p>スキーマファイルをデフォルトから複製する</p>
<div class="highlight" fn="shell"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">% php artisan vendor:publish --tag<span style="color:#f92672">=</span>lighthouse-schema
</code></pre></div><p>コメントは削除した</p>
<div class="highlight" fn="src/graphql/schema.graphql"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-graphql" data-lang="graphql"><span style="color:#66d9ef">scalar</span> <span style="color:#a6e22e">DateTime</span> <span style="color:#a6e22e">@scalar</span>(class: <span style="color:#e6db74">&#34;Nuwave\\Lighthouse\\Schema\\Types\\Scalars\\DateTime&#34;</span>)

<span style="color:#a6e22e">type</span> Query {
    user(
      id: <span style="color:#a6e22e">ID</span> <span style="color:#a6e22e">@eq</span> <span style="color:#a6e22e">@rules</span>(apply: [<span style="color:#e6db74">&#34;prohibits:email&#34;</span>, <span style="color:#e6db74">&#34;required_without:email&#34;</span>])
      <span style="color:#a6e22e">email</span>: <span style="color:#a6e22e">String</span> <span style="color:#a6e22e">@eq</span> <span style="color:#a6e22e">@rules</span>(apply: [<span style="color:#e6db74">&#34;prohibits:id&#34;</span>, <span style="color:#e6db74">&#34;required_without:id&#34;</span>, <span style="color:#e6db74">&#34;email&#34;</span>])
    ): <span style="color:#a6e22e">User</span> <span style="color:#a6e22e">@find</span>
    <span style="color:#a6e22e">users</span>(
      name: <span style="color:#a6e22e">String</span> <span style="color:#a6e22e">@where</span>(operator: <span style="color:#e6db74">&#34;like&#34;</span>)
    ): [<span style="color:#a6e22e">User</span>!]! <span style="color:#a6e22e">@paginate</span>(<span style="color:#a6e22e">defaultCount</span>: <span style="color:#a6e22e">10</span>)
}

<span style="color:#66d9ef">type</span> <span style="color:#a6e22e">User</span> {
    id: <span style="color:#a6e22e">ID</span>!
    name: <span style="color:#a6e22e">String</span>!
    email: <span style="color:#a6e22e">String</span>!
    email_verified_at: <span style="color:#a6e22e">DateTime</span>
    created_at: <span style="color:#a6e22e">DateTime</span>!
    updated_at: <span style="color:#a6e22e">DateTime</span>!
}
</code></pre></div><h2 id="read">Read</h1>
<h2 id="複数取得">複数取得</h2>
<ul>
<li>Queryを使う</li>
<li>paginatorが必須としている<code>count</code>を指定する</li>
<li><code>currentPage</code>はなくても動作する</li>
<li><code>data</code>に欲しいUserの項目を指定する</li>
</ul>
<div class="highlight" fn="shell"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">% curl -XPOST -H <span style="color:#e6db74">&#39;Content-Type: application/json&#39;</span> -d <span style="color:#e6db74">&#39;{&#34;query&#34;:&#34;{users{paginatorInfo{count,currentPage}data{id,name,email}}}&#34;}&#39;</span> localhost:8080/graphql
<span style="color:#f92672">{</span><span style="color:#e6db74">&#34;data&#34;</span>:<span style="color:#f92672">{</span><span style="color:#e6db74">&#34;users&#34;</span>:<span style="color:#f92672">{</span><span style="color:#e6db74">&#34;paginatorInfo&#34;</span>:<span style="color:#f92672">{</span><span style="color:#e6db74">&#34;count&#34;</span>:10,<span style="color:#e6db74">&#34;currentPage&#34;</span>:1<span style="color:#f92672">}</span>,<span style="color:#e6db74">&#34;data&#34;</span>:<span style="color:#f92672">[{</span><span style="color:#e6db74">&#34;id&#34;</span>:<span style="color:#e6db74">&#34;1&#34;</span>,<span style="color:#e6db74">&#34;name&#34;</span>:<span style="color:#e6db74">&#34;Mrs. Aglae Hayes PhD&#34;</span>,<span style="color:#e6db74">&#34;email&#34;</span>:<span style="color:#e6db74">&#34;cayla30@example.net&#34;</span><span style="color:#f92672">}</span>,<span style="color:#f92672">{</span><span style="color:#e6db74">&#34;id&#34;</span>:<span style="color:#e6db74">&#34;2&#34;</span>,<span style="color:#e6db74">&#34;name&#34;</span>:<span style="color:#e6db74">&#34;Delfina Bartell&#34;</span>,<span style="color:#e6db74">&#34;email&#34;</span>:<span style="color:#e6db74">&#34;audreanne01@example.org&#34;</span><span style="color:#f92672">}</span>,<span style="color:#f92672">{</span><span style="color:#e6db74">&#34;id&#34;</span>:<span style="color:#e6db74">&#34;3&#34;</span>,<span style="color:#e6db74">&#34;name&#34;</span>:<span style="color:#e6db74">&#34;Darius Lehner PhD&#34;</span>,<span style="color:#e6db74">&#34;email&#34;</span>:<span style="color:#e6db74">&#34;zheidenreich@example.org&#34;</span><span style="color:#f92672">}</span>,<span style="color:#f92672">{</span><span style="color:#e6db74">&#34;id&#34;</span>:<span style="color:#e6db74">&#34;4&#34;</span>,<span style="color:#e6db74">&#34;name&#34;</span>:<span style="color:#e6db74">&#34;Chase Trantow&#34;</span>,<span style="color:#e6db74">&#34;email&#34;</span>:<span style="color:#e6db74">&#34;franecki.roxane@example.net&#34;</span><span style="color:#f92672">}</span>,<span style="color:#f92672">{</span><span style="color:#e6db74">&#34;id&#34;</span>:<span style="color:#e6db74">&#34;5&#34;</span>,<span style="color:#e6db74">&#34;name&#34;</span>:<span style="color:#e6db74">&#34;Cielo Morar PhD&#34;</span>,<span style="color:#e6db74">&#34;email&#34;</span>:<span style="color:#e6db74">&#34;lubowitz.jonathon@example.net&#34;</span><span style="color:#f92672">}</span>,<span style="color:#f92672">{</span><span style="color:#e6db74">&#34;id&#34;</span>:<span style="color:#e6db74">&#34;6&#34;</span>,<span style="color:#e6db74">&#34;name&#34;</span>:<span style="color:#e6db74">&#34;Florine Kuhic&#34;</span>,<span style="color:#e6db74">&#34;email&#34;</span>:<span style="color:#e6db74">&#34;stephon40@example.com&#34;</span><span style="color:#f92672">}</span>,<span style="color:#f92672">{</span><span style="color:#e6db74">&#34;id&#34;</span>:<span style="color:#e6db74">&#34;7&#34;</span>,<span style="color:#e6db74">&#34;name&#34;</span>:<span style="color:#e6db74">&#34;Ms. Eugenia Lueilwitz Jr.&#34;</span>,<span style="color:#e6db74">&#34;email&#34;</span>:<span style="color:#e6db74">&#34;arch.collins@example.org&#34;</span><span style="color:#f92672">}</span>,<span style="color:#f92672">{</span><span style="color:#e6db74">&#34;id&#34;</span>:<span style="color:#e6db74">&#34;8&#34;</span>,<span style="color:#e6db74">&#34;name&#34;</span>:<span style="color:#e6db74">&#34;Cindy Welch&#34;</span>,<span style="color:#e6db74">&#34;email&#34;</span>:<span style="color:#e6db74">&#34;bridgette.hintz@example.org&#34;</span><span style="color:#f92672">}</span>,<span style="color:#f92672">{</span><span style="color:#e6db74">&#34;id&#34;</span>:<span style="color:#e6db74">&#34;9&#34;</span>,<span style="color:#e6db74">&#34;name&#34;</span>:<span style="color:#e6db74">&#34;Ms. Cordie Waelchi&#34;</span>,<span style="color:#e6db74">&#34;email&#34;</span>:<span style="color:#e6db74">&#34;ncassin@example.com&#34;</span><span style="color:#f92672">}</span>,<span style="color:#f92672">{</span><span style="color:#e6db74">&#34;id&#34;</span>:<span style="color:#e6db74">&#34;10&#34;</span>,<span style="color:#e6db74">&#34;name&#34;</span>:<span style="color:#e6db74">&#34;Ms. Rhoda Schaden&#34;</span>,<span style="color:#e6db74">&#34;email&#34;</span>:<span style="color:#e6db74">&#34;zlebsack@example.net&#34;</span><span style="color:#f92672">}]}}}</span>
</code></pre></div><p>1件のみ取得</p>
<ul>
<li>件数の絞りは<code>first</code>を使う（<code>first</code>は内部で定義されている）</li>
</ul>
<div class="highlight" fn="shell"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">% curl -XPOST -H <span style="color:#e6db74">&#39;Content-Type: application/json&#39;</span> -d <span style="color:#e6db74">&#39;{&#34;query&#34;:&#34;{users(first:1){paginatorInfo{count,currentPage}data{id,name,email}}}&#34;}&#39;</span> localhost:8080/graphql
<span style="color:#f92672">{</span><span style="color:#e6db74">&#34;data&#34;</span>:<span style="color:#f92672">{</span><span style="color:#e6db74">&#34;users&#34;</span>:<span style="color:#f92672">{</span><span style="color:#e6db74">&#34;paginatorInfo&#34;</span>:<span style="color:#f92672">{</span><span style="color:#e6db74">&#34;count&#34;</span>:1,<span style="color:#e6db74">&#34;currentPage&#34;</span>:1<span style="color:#f92672">}</span>,<span style="color:#e6db74">&#34;data&#34;</span>:<span style="color:#f92672">[{</span><span style="color:#e6db74">&#34;id&#34;</span>:<span style="color:#e6db74">&#34;1&#34;</span>,<span style="color:#e6db74">&#34;name&#34;</span>:<span style="color:#e6db74">&#34;Mrs. Aglae Hayes PhD&#34;</span>,<span style="color:#e6db74">&#34;email&#34;</span>:<span style="color:#e6db74">&#34;cayla30@example.net&#34;</span><span style="color:#f92672">}]}}}</span>
</code></pre></div><p>1件かつ2ページ目</p>
<ul>
<li>ページ指定は<code>page</code>を使う</li>
</ul>
<div class="highlight" fn="shell"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">% curl -XPOST -H <span style="color:#e6db74">&#39;Content-Type: application/json&#39;</span> -d <span style="color:#e6db74">&#39;{&#34;query&#34;:&#34;{users(first:1,page:2){paginatorInfo{count,currentPage}data{id,name,email}}}&#34;}&#39;</span> localhost:8080/graphql
<span style="color:#f92672">{</span><span style="color:#e6db74">&#34;data&#34;</span>:<span style="color:#f92672">{</span><span style="color:#e6db74">&#34;users&#34;</span>:<span style="color:#f92672">{</span><span style="color:#e6db74">&#34;paginatorInfo&#34;</span>:<span style="color:#f92672">{</span><span style="color:#e6db74">&#34;count&#34;</span>:1,<span style="color:#e6db74">&#34;currentPage&#34;</span>:2<span style="color:#f92672">}</span>,<span style="color:#e6db74">&#34;data&#34;</span>:<span style="color:#f92672">[{</span><span style="color:#e6db74">&#34;id&#34;</span>:<span style="color:#e6db74">&#34;2&#34;</span>,<span style="color:#e6db74">&#34;name&#34;</span>:<span style="color:#e6db74">&#34;Delfina Bartell&#34;</span>,<span style="color:#e6db74">&#34;email&#34;</span>:<span style="color:#e6db74">&#34;audreanne01@example.org&#34;</span><span style="color:#f92672">}]}}}</span>
</code></pre></div><p>名前で絞る</p>
<ul>
<li>LIKE検索になっているので<code>&quot;%foo%&quot;</code>の形にする</li>
</ul>
<div class="highlight" fn="shell"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">% curl -XPOST -H <span style="color:#e6db74">&#39;Content-Type: application/json&#39;</span> -d <span style="color:#e6db74">&#39;{&#34;query&#34;:&#34;{users(name:\&#34;%Aglae%\&#34;){paginatorInfo{count,currentPage}data{id,name,email}}}&#34;}&#39;</span> localhost:8080/graphql
<span style="color:#f92672">{</span><span style="color:#e6db74">&#34;data&#34;</span>:<span style="color:#f92672">{</span><span style="color:#e6db74">&#34;users&#34;</span>:<span style="color:#f92672">{</span><span style="color:#e6db74">&#34;paginatorInfo&#34;</span>:<span style="color:#f92672">{</span><span style="color:#e6db74">&#34;count&#34;</span>:1,<span style="color:#e6db74">&#34;currentPage&#34;</span>:1<span style="color:#f92672">}</span>,<span style="color:#e6db74">&#34;data&#34;</span>:<span style="color:#f92672">[{</span><span style="color:#e6db74">&#34;id&#34;</span>:<span style="color:#e6db74">&#34;1&#34;</span>,<span style="color:#e6db74">&#34;name&#34;</span>:<span style="color:#e6db74">&#34;Mrs. Aglae Hayes PhD&#34;</span>,<span style="color:#e6db74">&#34;email&#34;</span>:<span style="color:#e6db74">&#34;cayla30@example.net&#34;</span><span style="color:#f92672">}]}}}</span>
</code></pre></div><h2 id="1件取得">1件取得</h2>
<p>ID指定</p>
<div class="highlight" fn="shell"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">% curl -XPOST -H <span style="color:#e6db74">&#39;Content-Type: application/json&#39;</span> -d <span style="color:#e6db74">&#39;{&#34;query&#34;:&#34;{user(id:1){id,name,email}}&#34;}&#39;</span> localhost:8080/graphql
<span style="color:#f92672">{</span><span style="color:#e6db74">&#34;data&#34;</span>:<span style="color:#f92672">{</span><span style="color:#e6db74">&#34;user&#34;</span>:<span style="color:#f92672">{</span><span style="color:#e6db74">&#34;id&#34;</span>:<span style="color:#e6db74">&#34;1&#34;</span>,<span style="color:#e6db74">&#34;name&#34;</span>:<span style="color:#e6db74">&#34;Mrs. Aglae Hayes PhD&#34;</span>,<span style="color:#e6db74">&#34;email&#34;</span>:<span style="color:#e6db74">&#34;cayla30@example.net&#34;</span><span style="color:#f92672">}}</span>
</code></pre></div><p>email指定</p>
<div class="highlight" fn="shell"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">% curl -XPOST -H <span style="color:#e6db74">&#39;Content-Type: application/json&#39;</span> -d <span style="color:#e6db74">&#39;{&#34;query&#34;:&#34;{user(email:\&#34;cayla30@example.net\&#34;){id,name,email}}&#34;}&#39;</span> localhost:8080/graphql
<span style="color:#f92672">{</span><span style="color:#e6db74">&#34;data&#34;</span>:<span style="color:#f92672">{</span><span style="color:#e6db74">&#34;user&#34;</span>:<span style="color:#f92672">{</span><span style="color:#e6db74">&#34;id&#34;</span>:<span style="color:#e6db74">&#34;1&#34;</span>,<span style="color:#e6db74">&#34;name&#34;</span>:<span style="color:#e6db74">&#34;Mrs. Aglae Hayes PhD&#34;</span>,<span style="color:#e6db74">&#34;email&#34;</span>:<span style="color:#e6db74">&#34;cayla30@example.net&#34;</span><span style="color:#f92672">}}}</span>
</code></pre></div><p>スキーマを見るとID指定は<code>required_without:email</code>、email指定は<code>required_without:id</code>となっているのでどちらかが必須となる</p>
<h2 id="リレーション">リレーション</h2>
<ul>
<li>リレーション定義
<ul>
<li>User:Post=1:N</li>
</ul>
</li>
<li>モデル、マイグレーション、ファクトリーは通常の書き方でOK</li>
</ul>
<p>各Userが2つのPostを持つように書き換える</p>
<div class="highlight" fn="database/seeders/DatabaseSeeder.php"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-diff" data-lang="diff">     public function run()
     {
         \App\Models\User::factory(10)
<span style="color:#a6e22e">+            -&gt;hasPosts(2)
</span><span style="color:#a6e22e"></span>             -&gt;create();
</code></pre></div><div class="highlight" fn="src/graphql/schema.graphql"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-diff" data-lang="diff">type Query {
    user(
        id: ID @eq @rules(apply: [&#34;prohibits:email&#34;, &#34;required_without:email&#34;])
        email: String @eq @rules(apply: [&#34;prohibits:id&#34;, &#34;required_without:id&#34;, &#34;email&#34;])
    ): User @find
    users(
        name: String @where(operator: &#34;like&#34;)
    ): [User!]! @paginate(defaultCount: 10)

<span style="color:#a6e22e">+   post(id: ID @eq): Post @find
</span><span style="color:#a6e22e"></span>}

type User {
    id: ID!
    name: String!
    email: String!
    email_verified_at: DateTime
    created_at: DateTime!
    updated_at: DateTime!
<span style="color:#a6e22e">+   posts: [Post!]!
</span><span style="color:#a6e22e"></span>}

<span style="color:#a6e22e">+ type Post {
</span><span style="color:#a6e22e">+     id: ID!
</span><span style="color:#a6e22e">+     title: String!
</span><span style="color:#a6e22e">+     user: User!
</span><span style="color:#a6e22e">+ }
</span></code></pre></div><p><code>@belongsTo</code>や<code>@hasMany</code>ディレクティブがあるがモデルにリレーションメソッドがあれば自動で紐づくのでつけなくても良い</p>
<div class="highlight" fn="app/Models/User.php"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-php" data-lang="php"><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">User</span> <span style="color:#66d9ef">extends</span> <span style="color:#a6e22e">Model</span>
{
    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">function</span> <span style="color:#a6e22e">posts</span>()
    {
        <span style="color:#66d9ef">return</span> $this<span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">hasMany</span>(<span style="color:#a6e22e">\App\Models\Post</span><span style="color:#f92672">::</span><span style="color:#a6e22e">class</span>);
    }
}
</code></pre></div><p>以下のように明示しても動作する</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-graphql" data-lang="graphql"><span style="color:#66d9ef">type</span> <span style="color:#a6e22e">User</span> {
    posts: [<span style="color:#a6e22e">Post</span>!]! <span style="color:#a6e22e">@hasMany</span>
}
</code></pre></div><h3 id="belongsto">belongsTo</h3>
<div class="highlight" fn="shell"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">% curl -XPOST -H <span style="color:#e6db74">&#39;Content-Type: application/json&#39;</span> -d <span style="color:#e6db74">&#39;{&#34;query&#34;:&#34;{post(id:1){id,title,user{id,name,email}}}&#34;}&#39;</span> localhost:8080/graphql
<span style="color:#f92672">{</span><span style="color:#e6db74">&#34;data&#34;</span>:<span style="color:#f92672">{</span><span style="color:#e6db74">&#34;post&#34;</span>:<span style="color:#f92672">{</span><span style="color:#e6db74">&#34;id&#34;</span>:<span style="color:#e6db74">&#34;1&#34;</span>,<span style="color:#e6db74">&#34;title&#34;</span>:<span style="color:#e6db74">&#34;Voluptate praesentium et dicta animi aliquid. Aperiam sunt ut a eum. Maiores aliquam expedita dignissimos.&#34;</span>,<span style="color:#e6db74">&#34;user&#34;</span>:<span style="color:#f92672">{</span><span style="color:#e6db74">&#34;id&#34;</span>:<span style="color:#e6db74">&#34;1&#34;</span>,<span style="color:#e6db74">&#34;name&#34;</span>:<span style="color:#e6db74">&#34;Mr. Herminio Fisher&#34;</span>,<span style="color:#e6db74">&#34;email&#34;</span>:<span style="color:#e6db74">&#34;kkuhic@example.net&#34;</span><span style="color:#f92672">}}}}</span>
</code></pre></div><figure><img src="https://oda.world/images/129/3.webp"/>
</figure>

<h3 id="hasmany">hasMany</h3>
<div class="highlight" fn="shell"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">% curl -XPOST -H <span style="color:#e6db74">&#39;Content-Type: application/json&#39;</span> -d <span style="color:#e6db74">&#39;{&#34;query&#34;:&#34;{user(id:1){id,name,email,posts{id,title}}}&#34;}&#39;</span> localhost:8080/graphql
<span style="color:#f92672">{</span><span style="color:#e6db74">&#34;data&#34;</span>:<span style="color:#f92672">{</span><span style="color:#e6db74">&#34;user&#34;</span>:<span style="color:#f92672">{</span><span style="color:#e6db74">&#34;id&#34;</span>:<span style="color:#e6db74">&#34;1&#34;</span>,<span style="color:#e6db74">&#34;name&#34;</span>:<span style="color:#e6db74">&#34;Mr. Herminio Fisher&#34;</span>,<span style="color:#e6db74">&#34;email&#34;</span>:<span style="color:#e6db74">&#34;kkuhic@example.net&#34;</span>,<span style="color:#e6db74">&#34;posts&#34;</span>:<span style="color:#f92672">[{</span><span style="color:#e6db74">&#34;id&#34;</span>:<span style="color:#e6db74">&#34;1&#34;</span>,<span style="color:#e6db74">&#34;title&#34;</span>:<span style="color:#e6db74">&#34;Voluptate praesentium et dicta animi aliquid. Aperiam sunt ut a eum. Maiores aliquam expedita dignissimos.&#34;</span><span style="color:#f92672">}</span>,<span style="color:#f92672">{</span><span style="color:#e6db74">&#34;id&#34;</span>:<span style="color:#e6db74">&#34;2&#34;</span>,<span style="color:#e6db74">&#34;title&#34;</span>:<span style="color:#e6db74">&#34;Est et cumque voluptate dignissimos neque aut. A ut qui magnam sapiente nobis cupiditate molestiae. Voluptate quasi debitis qui. Voluptates sequi non eius maiores vero tempore eos.&#34;</span><span style="color:#f92672">}]}}}</span>
</code></pre></div><figure><img src="https://oda.world/images/129/4.webp"/>
</figure>

<h2 id="create">Create</h1>
<ul>
<li>typeはMutationになる</li>
<li>戻り値が対象のモデルになる</li>
<li><code>@create</code>でEloquentの<code>create()</code>を指定している</li>
</ul>
<h2 id="1件新規作成">1件新規作成</h2>
<div class="highlight" fn="src/graphql/schema.graphql"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-graphql" data-lang="graphql"><span style="color:#66d9ef">type</span> <span style="color:#a6e22e">Mutation</span> {
    createUser(
        name: <span style="color:#a6e22e">String</span>!
        email: <span style="color:#a6e22e">String</span>!
        password: <span style="color:#a6e22e">String</span>!
    ): <span style="color:#a6e22e">User</span>! <span style="color:#a6e22e">@create</span>
}
</code></pre></div><div class="highlight" fn="shell"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">% curl -XPOST -H <span style="color:#e6db74">&#39;Content-Type: application/json&#39;</span> -d <span style="color:#e6db74">&#39;{&#34;query&#34;:&#34;mutation{createUser(name:\&#34;foo\&#34;,email:\&#34;foo@sample.com\&#34;,password:\&#34;password\&#34;){id,name,email}}&#34;}&#39;</span> localhost:8080/graphql
<span style="color:#f92672">{</span><span style="color:#e6db74">&#34;data&#34;</span>:<span style="color:#f92672">{</span><span style="color:#e6db74">&#34;createUser&#34;</span>:<span style="color:#f92672">{</span><span style="color:#e6db74">&#34;id&#34;</span>:<span style="color:#e6db74">&#34;11&#34;</span>,<span style="color:#e6db74">&#34;name&#34;</span>:<span style="color:#e6db74">&#34;foo&#34;</span>,<span style="color:#e6db74">&#34;email&#34;</span>:<span style="color:#e6db74">&#34;foo@sample.com&#34;</span><span style="color:#f92672">}}}</span>
</code></pre></div><figure><img src="https://oda.world/images/129/5.webp"/>
</figure>

<h2 id="リレーション-1">リレーション</h2>
<div class="message ">

ネストされたMutationが動作されるには、モデルのリレーションを定義するメソッドの戻り値が必ず必要になる

</div>

<div class="highlight" fn="app/Models/User.php"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-php" data-lang="php"><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">User</span> <span style="color:#66d9ef">extends</span> <span style="color:#a6e22e">Model</span>
{
    <span style="color:#75715e">// 動作しない
</span><span style="color:#75715e"></span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">function</span> <span style="color:#a6e22e">posts</span>()
    {
        <span style="color:#66d9ef">return</span> $this<span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">hasMany</span>(<span style="color:#a6e22e">\App\Models\Post</span><span style="color:#f92672">::</span><span style="color:#a6e22e">class</span>);
    }
    
    <span style="color:#75715e">// 動作する
</span><span style="color:#75715e"></span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">function</span> <span style="color:#a6e22e">posts</span>()<span style="color:#f92672">:</span> <span style="color:#a6e22e">HasMany</span>
    {
        <span style="color:#66d9ef">return</span> $this<span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">hasMany</span>(<span style="color:#a6e22e">\App\Models\Post</span><span style="color:#f92672">::</span><span style="color:#a6e22e">class</span>);
    }
}
</code></pre></div><h3 id="hasmany-1">hasMany</h3>
<p>以下は新しくUserを作り、さらにそのUserのPostまで作るMutationになる</p>
<p>またhasManyに限らずリレーションを使ったMutationはtype<code>input</code>を利用することになる</p>
<p><code>input</code>は入力パラメータをまとめるものという認識で問題ない</p>
<div class="highlight" fn="src/graphql/schema.graphql"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-graphql" data-lang="graphql"><span style="color:#66d9ef">type</span> <span style="color:#a6e22e">Mutation</span> {
    createUser(<span style="color:#66d9ef">input</span>: <span style="color:#a6e22e">CreateUserInput</span>! <span style="color:#a6e22e">@spread</span>): <span style="color:#a6e22e">User</span>! <span style="color:#a6e22e">@create</span>
}

<span style="color:#a6e22e">input</span> CreateUserInput {
    name: <span style="color:#a6e22e">String</span>!
    email: <span style="color:#a6e22e">String</span>!
    password: <span style="color:#a6e22e">String</span>!
    posts: <span style="color:#a6e22e">CreatePostsInput</span> <span style="color:#75715e"># Userモデルのリレーションメソッドであるposts()を指定する </span>
}

<span style="color:#66d9ef">input</span> <span style="color:#a6e22e">CreatePostsInput</span> {
    create: [<span style="color:#a6e22e">CreatePostInput</span>!]!
}

<span style="color:#66d9ef">input</span> <span style="color:#a6e22e">CreatePostInput</span> {
    title: <span style="color:#a6e22e">String</span>! <span style="color:#75715e"># Postモデルの新規作成に必要な項目</span>
}
</code></pre></div><p><code>CreatePostsInput</code>で定義している<code>create:</code>はPostをどうするか決定するオペレーションである</p>
<p>ここでは新規作成だが他にも<code>update</code>や<code>delete</code>などがある</p>
<div class="highlight" fn="shell"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">% curl -XPOST -H <span style="color:#e6db74">&#39;Content-Type: application/json&#39;</span> -d <span style="color:#e6db74">&#39;{&#34;query&#34;:&#34;mutation{createUser(input:{name:\&#34;foo\&#34;,email:\&#34;foo@sample.com\&#34;,password:\&#34;password\&#34;,posts:{create:[{title:\&#34;foo\&#34;}]}}){id,name,email,posts{id,title}}}&#34;}&#39;</span> localhost:8080/graphql
<span style="color:#f92672">{</span><span style="color:#e6db74">&#34;data&#34;</span>:<span style="color:#f92672">{</span><span style="color:#e6db74">&#34;createUser&#34;</span>:<span style="color:#f92672">{</span><span style="color:#e6db74">&#34;id&#34;</span>:<span style="color:#e6db74">&#34;11&#34;</span>,<span style="color:#e6db74">&#34;name&#34;</span>:<span style="color:#e6db74">&#34;foo&#34;</span>,<span style="color:#e6db74">&#34;email&#34;</span>:<span style="color:#e6db74">&#34;foo@sample.com&#34;</span>,<span style="color:#e6db74">&#34;posts&#34;</span>:<span style="color:#f92672">[{</span><span style="color:#e6db74">&#34;id&#34;</span>:<span style="color:#e6db74">&#34;21&#34;</span>,<span style="color:#e6db74">&#34;title&#34;</span>:<span style="color:#e6db74">&#34;foo&#34;</span><span style="color:#f92672">}]}}}</span> 
</code></pre></div><figure><img src="https://oda.world/images/129/6.webp"/>
</figure>

<h2 id="update">Update</h1>
<ul>
<li>typeはMutationになる</li>
<li>戻り値が対象のモデルになる</li>
<li>ID型としてPrimary Keyが必須</li>
</ul>
<h2 id="1件更新">1件更新</h2>
<p>サンプルとしてあるUserのnameを更新する</p>
<div class="highlight" fn="src/graphql/schema.graphql"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-diff" data-lang="diff">type Mutation {
    createUser(input: CreateUserInput! @spread): User! @create
    
<span style="color:#a6e22e">+    updateUser(
</span><span style="color:#a6e22e">+        id: ID!
</span><span style="color:#a6e22e">+        name: String!
</span><span style="color:#a6e22e">+    ): User! @update
</span><span style="color:#a6e22e"></span>}
</code></pre></div><div class="highlight" fn="shell"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">% curl -XPOST -H <span style="color:#e6db74">&#34;Content-Type: application/json&#34;</span> -d <span style="color:#e6db74">&#39;{&#34;query&#34;:&#34;query{user(id:1){id,name}}&#34;}&#39;</span> localhost:8080/graphql
<span style="color:#f92672">{</span><span style="color:#e6db74">&#34;data&#34;</span>:<span style="color:#f92672">{</span><span style="color:#e6db74">&#34;user&#34;</span>:<span style="color:#f92672">{</span><span style="color:#e6db74">&#34;id&#34;</span>:<span style="color:#e6db74">&#34;1&#34;</span>,<span style="color:#e6db74">&#34;name&#34;</span>:<span style="color:#e6db74">&#34;Leanne Sipes&#34;</span><span style="color:#f92672">}}}</span>

% curl -XPOST -H <span style="color:#e6db74">&#34;Content-Type: application/json&#34;</span> -d <span style="color:#e6db74">&#39;{&#34;query&#34;:&#34;mutation{updateUser(id:1,name:\&#34;updated name\&#34;){id,name}}&#34;}&#39;</span> localhost:8080/graphql
<span style="color:#f92672">{</span><span style="color:#e6db74">&#34;data&#34;</span>:<span style="color:#f92672">{</span><span style="color:#e6db74">&#34;updateUser&#34;</span>:<span style="color:#f92672">{</span><span style="color:#e6db74">&#34;id&#34;</span>:<span style="color:#e6db74">&#34;1&#34;</span>,<span style="color:#e6db74">&#34;name&#34;</span>:<span style="color:#e6db74">&#34;updated name&#34;</span><span style="color:#f92672">}}}</span>

% curl -XPOST -H <span style="color:#e6db74">&#34;Content-Type: application/json&#34;</span> -d <span style="color:#e6db74">&#39;{&#34;query&#34;:&#34;query{user(id:1){id,name}}&#34;}&#39;</span> localhost:8080/graphql
<span style="color:#f92672">{</span><span style="color:#e6db74">&#34;data&#34;</span>:<span style="color:#f92672">{</span><span style="color:#e6db74">&#34;user&#34;</span>:<span style="color:#f92672">{</span><span style="color:#e6db74">&#34;id&#34;</span>:<span style="color:#e6db74">&#34;1&#34;</span>,<span style="color:#e6db74">&#34;name&#34;</span>:<span style="color:#e6db74">&#34;updated name&#34;</span><span style="color:#f92672">}}}</span>
</code></pre></div><figure><img src="https://oda.world/images/129/7.webp"/>
</figure>

<p>Primary Keyの指定がない場合はエラーとなる</p>
<figure><img src="https://oda.world/images/129/8.webp"/>
</figure>

<p>inputでまとめることも可能</p>
<div class="highlight" fn="src/graphql/schema.graphql"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-graphql" data-lang="graphql"><span style="color:#66d9ef">type</span> <span style="color:#a6e22e">Mutation</span> {
    updateUser(
        <span style="color:#66d9ef">input</span>: <span style="color:#a6e22e">UpdateUserInput</span>! <span style="color:#a6e22e">@spread</span>
    ): <span style="color:#a6e22e">User</span>! <span style="color:#a6e22e">@update</span>
}

<span style="color:#a6e22e">input</span> UpdateUserInput {
    id: <span style="color:#a6e22e">ID</span>!
    name: <span style="color:#a6e22e">String</span>!
}
</code></pre></div><div class="highlight" fn="shell"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">% curl -XPOST -H <span style="color:#e6db74">&#34;Content-Type: application/json&#34;</span> -d <span style="color:#e6db74">&#39;{&#34;query&#34;:&#34;mutation{updateUser(input:{id:1,name:\&#34;after name\&#34;}){id,name}}&#34;}&#39;</span> localhost:8080/graphql
<span style="color:#f92672">{</span><span style="color:#e6db74">&#34;data&#34;</span>:<span style="color:#f92672">{</span><span style="color:#e6db74">&#34;updateUser&#34;</span>:<span style="color:#f92672">{</span><span style="color:#e6db74">&#34;id&#34;</span>:<span style="color:#e6db74">&#34;1&#34;</span>,<span style="color:#e6db74">&#34;name&#34;</span>:<span style="color:#e6db74">&#34;after name&#34;</span><span style="color:#f92672">}}}</span>
</code></pre></div><h2 id="tips">TIPS</h1>
<h2 id="補完">補完</h2>
<p>このようなシンタックスエラーが気になる時はヘルパーファイルを作ると良い</p>
<figure><img src="https://oda.world/images/129/1.webp"/>
</figure>

<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">% php artisan lighthouse:ide-helper
Wrote schema directive definitions to /var/www/html/schema-directives.graphql.
Wrote definitions <span style="color:#66d9ef">for</span> programmatically registered types to /var/www/html/programmatic-types.graphql.
Wrote PHP definitions to /var/www/html/_lighthouse_ide_helper.php.

It is recommended to add them to your .gitignore file.
</code></pre></div><h2 id="gui">GUI</h2>
<p><a href="https://github.com/mll-lab/laravel-graphql-playground">laravel-graphql-playground</a>というのが紹介されているのでインストールする</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">% composer require mll-lab/laravel-graphiql
</code></pre></div><p><code>graphiql</code>というエンドポイントが追加される</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">% php artisan route:list

  GET|HEAD   / ........................................................................................................ 
  POST       _ignition/execute-solution . ignition.executeSolution › Spatie<span style="color:#ae81ff">\L</span>aravelIgnition › ExecuteSolutionController
  GET|HEAD   _ignition/health-check ............. ignition.healthCheck › Spatie<span style="color:#ae81ff">\L</span>aravelIgnition › HealthCheckController
  POST       _ignition/update-config .......... ignition.updateConfig › Spatie<span style="color:#ae81ff">\L</span>aravelIgnition › UpdateConfigController
  GET|HEAD   api/user ................................................................................................. 
  GET|HEAD   graphiql .................................................... graphiql › MLL<span style="color:#ae81ff">\G</span>raphiQL › GraphiQLController
  GET|POST|HEAD graphql ............................................... graphql › Nuwave<span style="color:#ae81ff">\L</span>ighthouse › GraphQLController
  GET|HEAD   sanctum/csrf-cookie .................... sanctum.csrf-cookie › Laravel<span style="color:#ae81ff">\S</span>anctum › CsrfCookieController@show

                                                                                                     Showing <span style="color:#f92672">[</span>8<span style="color:#f92672">]</span> routes
</code></pre></div><p>実際にアクセスしてクエリを書くと結果が返ってくる</p>
<figure><img src="https://oda.world/images/129/2.webp"/>
</figure>

<h2 id="参考">参考</h1>
<ul>
<li><a href="https://lighthouse-php.com/">https://lighthouse-php.com/</a></li>
<li><a href="https://graphql.org/">https://graphql.org/</a></li>
<li><a href="https://learn.liferay.com/dxp/latest/ja/headless-delivery/consuming-apis/consuming-graphql-apis.html">https://learn.liferay.com/dxp/latest/ja/headless-delivery/consuming-apis/consuming-graphql-apis.html</a></li>
<li><a href="https://qiita.com/yousan/items/c898f0d2ceb8f145e5a4">https://qiita.com/yousan/items/c898f0d2ceb8f145e5a4</a></li>
<li><a href="https://qiita.com/jintz/items/c9105dca1725224d36a8">https://qiita.com/jintz/items/c9105dca1725224d36a8</a></li>
<li><a href="https://qiita.com/TsukasaGR/items/1a8b0020e5e83e7a46c7">https://qiita.com/TsukasaGR/items/1a8b0020e5e83e7a46c7</a></li>
<li><a href="https://github.com/mll-lab/laravel-graphql-playground">https://github.com/mll-lab/laravel-graphql-playground</a></li>
<li><a href="https://speakerdeck.com/d_endo/laravel-plus-lighthousedeshi-merudi-kosutonagraphqlru-men">https://speakerdeck.com/d_endo/laravel-plus-lighthousedeshi-merudi-kosutonagraphqlru-men</a></li>
</ul>


          <hr>

          <div class="tags">
  
    
      <a href="https://oda.world/tags/laravel/" class="tag"># laravel</a>
    
      <a href="https://oda.world/tags/graphql/" class="tag"># graphql</a>
    
  
</div>
        </div>
      </div>
      <div class="col-md-3">
        <div class="toc sticky-top">
          <div class="toc-title">
            目次
          </div>
          <div class="toc-body">
            <nav id="TableOfContents">
  <ul>
    <li><a href="#前提">前提</a></li>
    <li><a href="#sqlite準備">sqlite準備</a></li>
    <li><a href="#lighthouseをインストールする">Lighthouseをインストールする</a></li>
    <li><a href="#read">Read</a>
      <ul>
        <li><a href="#複数取得">複数取得</a></li>
        <li><a href="#1件取得">1件取得</a></li>
        <li><a href="#リレーション">リレーション</a>
          <ul>
            <li><a href="#belongsto">belongsTo</a></li>
            <li><a href="#hasmany">hasMany</a></li>
          </ul>
        </li>
      </ul>
    </li>
    <li><a href="#create">Create</a>
      <ul>
        <li><a href="#1件新規作成">1件新規作成</a></li>
        <li><a href="#リレーション-1">リレーション</a>
          <ul>
            <li><a href="#hasmany-1">hasMany</a></li>
          </ul>
        </li>
      </ul>
    </li>
    <li><a href="#update">Update</a>
      <ul>
        <li><a href="#1件更新">1件更新</a></li>
      </ul>
    </li>
    <li><a href="#tips">TIPS</a>
      <ul>
        <li><a href="#補完">補完</a></li>
        <li><a href="#gui">GUI</a></li>
      </ul>
    </li>
    <li><a href="#参考">参考</a></li>
  </ul>
</nav>
          </div>
        </div>
      </div>
    </div>
  </div>
</article>

  <footer>
    <div class="container">
      <div class="copyright">
        © 2021 ODA WORLD
      </div>
    </div>
  </footer>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.6.0/highlight.min.js"></script>
  <script>hljs.initHighlightingOnLoad();</script>

  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js" integrity="sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM" crossorigin="anonymous"></script>

  </body>
</html>

