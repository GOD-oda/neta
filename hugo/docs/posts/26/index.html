<!DOCTYPE html>
<html lang="ja">
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1.0, user-scalable=no"/>
  <title>26</title>
  <link href="https://GOD-oda.github.io/neta/css/materialize.min.css" type="text/css" rel="stylesheet" media="screen,projection"/>
  <link href="https://GOD-oda.github.io/neta/css/style.css" type="text/css" rel="stylesheet" media="screen,projection"/>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/8.6/styles/default.min.css">
  
  <link rel="stylesheet" href="https://GOD-oda.github.io/neta/sass/main.min.3e0916b260b32154b57e0520d2082841344953658a407cbc5b2a78d22f1868e8.css">
  <style type="text/css">
  
    footer.page-footer{background-image: url(https://GOD-oda.github.io/neta/images/default.png);}
  
  </style>
  
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-93E1496REW"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'G-93E1496REW');
  </script>
</head>
<body>
  <ul id="slide-out" class="side-nav">
    <li><a href="https://GOD-oda.github.io/neta"><i class="mdi-action-home left"></i>Home<i class="mdi-hardware-keyboard-arrow-right right"></i></a></li>
    <li><a href="https://GOD-oda.github.io/neta/categories"><i class="mdi-action-perm-media left"></i>Categories<i class="mdi-hardware-keyboard-arrow-right right"></i></a></li>
    <li><a href="https://GOD-oda.github.io/neta/tags"><i class="mdi-action-loyalty left"></i>Tags<i class="mdi-hardware-keyboard-arrow-right right"></i></a></li>
  </ul>
  <div id="index-banner" class="parallax-container">
  <a data-activates="slide-out" class="btn-floating button-collapse" style="top: 5px; left: 5px;"><i class="mdi-navigation-menu"></i></a>
    <div class="section no-pad-bot">
      <div class="container">
        
        <h1 class="header center teal-text text-lighten-2">ODA WORLD</h1>
        <div class="row center">
          <h5 class="header col s12 light"></h5>
        </div>
        <div class="row center">
        
        
        
        
        
        
          <a href="https://GOD-oda.github.io/neta/index.xml"><img src="https://GOD-oda.github.io/neta/images/feed-dreamstale27.png"></a>
        </div>
      </div>
    </div>
    <div class="parallax">
    
      <img src="https://GOD-oda.github.io/neta/images/default.png">
    
    </div>
  </div>



<div class="container">
  <div class="section">

    <div class="row">
      <div class="col s12">
        <div class="card-panel">
          <h4>26</h4>
          <p>
           
          </p>
          <p><h1 id="結論">結論</h1>
<p>column1でグルーピングした中で、column2の値が一番大きいレコードを取りたい時</p>
<pre><code>SELECT * FROM table t1 LEFT JOIN table t2 ON t1.column1 = t2.column1 AND t1.column2 &lt; t2.column2 WHERE t2.column2 IS NULL;
</code></pre><p><a href="https://dev.mysql.com/doc/refman/5.6/ja/example-maximum-column-group-row.html">mysqlの公式</a>にもあるように自己結合し、右テーブルの特定のカラムがnullになるものをとる</p>
<h1 id="環境">環境</h1>
<ul>
<li>Docker version 19.03.13, build 4484c46d9d</li>
<li>mysql:5.6
<ul>
<li>my.confは未指定なのでデフォルト</li>
</ul>
</li>
</ul>
<h1 id="準備">準備</h1>
<p>mysql5.6のイメージをダウンロードする</p>
<pre><code>% docker pull mysql:5.6
</code></pre><p>コンテナを起動する</p>
<pre><code>% docker run -it --name mysql56 -e MYSQL_ROOT_PASSWORD=password -d mysql:5.6
c10a602370212d74189076236de74f573a683c529f745c5ed5b60285c48d8120
</code></pre><p>確認</p>
<pre><code>% docker ps
CONTAINER ID        IMAGE               COMMAND                  CREATED             STATUS              PORTS               NAMES
c10a60237021        mysql:5.6           &quot;docker-entrypoint.s…&quot;   3 seconds ago       Up 2 seconds        3306/tcp            mysql56
</code></pre><p>コンテナに入る</p>
<pre><code>% docker exec -it mysql56 bash
root@c10a60237021:/#
</code></pre><p>mysqlに入る
passwordは<code>docker run</code>の<code>-e</code>オプションで指定したもの
ここでは<code>password</code></p>
<pre><code>root@c10a60237021:/# mysql -u root -p
Enter password:
Welcome to the MySQL monitor.  Commands end with ; or \g.
Your MySQL connection id is 2
Server version: 5.6.47 MySQL Community Server (GPL)

Copyright (c) 2000, 2020, Oracle and/or its affiliates. All rights reserved.

Oracle is a registered trademark of Oracle Corporation and/or its
affiliates. Other names may be trademarks of their respective
owners.

Type 'help;' or '\h' for help. Type '\c' to clear the current input statement.

mysql&gt;
</code></pre><p>必要なデータを作る</p>
<ul>
<li>データベース: test</li>
<li>テーブル: products
<ul>
<li>name: varchar(255)</li>
<li>price: int</li>
</ul>
</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sh" data-lang="sh">mysql&gt; create database test;
Query OK, <span style="color:#ae81ff">1</span> row affected <span style="color:#f92672">(</span>0.00 sec<span style="color:#f92672">)</span>
</code></pre></div><pre><code>mysql&gt; use test
Database changed
</code></pre><pre><code>mysql&gt; create table products (name varchar(255), price int);
Query OK, 0 rows affected (0.01 sec)
</code></pre><pre><code>mysql&gt; insert into products (name, price) values ('A', 100), ('B', 200), ('A', 300), ('B', 100);
Query OK, 4 rows affected (0.00 sec)
Records: 4  Duplicates: 0  Warnings: 0
</code></pre><pre><code>mysql&gt; select * from products;
+------+-------+
| name | price |
+------+-------+
| A    |   100 |
| B    |   200 |
| A    |   300 |
| B    |   100 |
+------+-------+
4 rows in set (0.00 sec)
</code></pre><h1 id="sql">SQL</h1>
<p>nameごとのグループのうち最大のpriceを持つレコードを抽出する</p>
<pre><code>mysql&gt; SELECT * FROM products t1 LEFT JOIN products t2 ON t1.name = t2.name AND t1.price &lt; t2.price WHERE t2.price IS NULL;
+------+-------+------+-------+
| name | price | name | price |
+------+-------+------+-------+
| B    |   200 | NULL |  NULL |
| A    |   300 | NULL |  NULL |
+------+-------+------+-------+
2 rows in set (0.00 sec)
</code></pre></p>
          <p>
            
          </p>
          <hr>
          <p>
            更新日 2021/08/15 18:49:20
          </p>
          
        </div>
      </div>
    </div>

    <div class="row">
      <div class="col s3 m1">
      
        <a class="btn-floating btn-large waves-effect waves-light" href="https://GOD-oda.github.io/neta/posts/28/"><i class="mdi-navigation-arrow-back"></i></a>
      
      </div>
      <div class="col s6 m10 center">&nbsp</div>
      <div class="col s3 m1">
      
        <a class="btn-floating btn-large waves-effect waves-light" href="https://GOD-oda.github.io/neta/posts/54/"><i class="mdi-navigation-arrow-forward"></i></a>
      
      </div>
    </div>

  </div>
</div>

  <footer class="page-footer">
    <div class="footer-copyright">
      <div class="container">
      
      <div class="right">Design <a class="grey-text text-lighten-4" href="http://pdevty.github.io/blog/">pdevty</a></div>
      </div>
    </div>
  </footer>
  <script src="https://code.jquery.com/jquery-2.1.4.min.js"></script>
  <script src="https://GOD-oda.github.io/neta/js/materialize.min.js"></script>
  <script src="https://GOD-oda.github.io/neta/js/init.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/8.6/highlight.min.js"></script>
  <script>hljs.initHighlightingOnLoad();</script>
  

  </body>
</html>

